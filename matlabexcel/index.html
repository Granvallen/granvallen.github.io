<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>用Matlab处理Excel | Granvallen;Nest</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + 'bf1ecb4728a04112cb191bc2e62aa815';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">用Matlab处理Excel</h1><a id="logo" href="/.">Granvallen;Nest</a><p class="description">人生苦短</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/guestbook/"><i class="fa fa-comments"> 留言</i></a><a href="/about/"><i class="fa fa-terminal"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><h1 class="post-title">用Matlab处理Excel</h1><div class="post-meta">Feb 26, 2018<span> | </span><span class="category"><a href="/categories/Coding/">Coding</a><a href="/categories/Coding/Matlab/">Matlab</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1,997</span><span class="post-meta-item-text"> 字</span></span></span><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><p>虽然最近比较多用Matlab做事, 但还没怎么正式地写过几篇讲讲Matlab. 嗯, 我是不是还忘了什么. . . （Mathematica QAQ）. </p>
<p>记起来之前写过一个Matlab与Excel交互处理表格的脚本, 于是又摸出了这篇博文. 事情是这样的, 作为一个苦逼的学习委员（基层干部）平时干得最多的事情当然是——打杂, 帮老师收个作业, 带个口信, 收收费什么的, 不过这些其中要说我比较讨厌的就是每次考试后的算绩点（好吧, 我承认我excel比较苦手）, 不知道其他学校怎么样, 我们是学委担此重任. 话说计算机的同学们, 你们都能拉出表格了不顺便算个GPA?其实我写了才知道最恶心的其实是处理表格的格式, 算绩点一句话就够了. . . </p>
<p>本文的脚本应该没有什么其他人能用得上, 因为各种格式都是按照表格和要求设计的, 不过其中的一些处理表格的方法还是值得做个笔记的. 受闪轨启发, 我把这个计划称为——学委解放战线</p>
<span id="more"></span>
<p>老师的要求也不复杂, 可以总结为两点: </p>
<ul>
<li>1.算出每个同学绩点与排名, 并且填入到姓名后新建的两列内, 并计算班级平均绩点. （挂科按60算）</li>
<li>2.筛选出低于60分不及格的成绩, 并用黄色填充. </li>
</ul>
<p>表格样本的原格式如下（我随便找的, 不算滥用职权吧）: </p>
<p><img src="https://raw.githubusercontent.com/Granvallen/granvallen.github.io/master/img/sheet1.PNG"  style="zoom:40%" alt="" align=center /></p>
<p>姓名我用序号代替了. </p>
<p>要用matlab来处理做到这些, 则需要解决: </p>
<ul>
<li>1.表格里的信息都是文本格式, 需要把数据与字符进行区分. </li>
<li>2.有些课程是等级评分, 分优、良、及格等, 需要转换为对应百分制分值再计算. </li>
<li>3.表格中包含了某些修读双学位或重修的额外课程, 如电气X班的表里还有修读金融学的同学, 而该班其他同学并不修这些金融学课程, 原则上计算绩点时, 这些课程是不算在内的. </li>
<li>4.有些缓考的同学某课成绩标注的是’-‘, 需要区分出来, 并不计入绩点计算. </li>
<li>5.matlab对表格的格式控制, 包括插入数据列、改变表格背景色等. </li>
<li>6.matlab矩阵元素序号到excel表格序号的转换. </li>
<li>7.先计算绩点, 然后计算排名. </li>
</ul>
<p>主要思路是把处理表格格式和处理数据分开来做, 处理表格格式用<strong>actxserver(‘excel.application’)</strong>创建excel应用类来做, 操作方法与C#处理excel相同, 具体使用方法可以参考<a target="_blank" rel="noopener" href="http://blog.csdn.net/north_easter/article/details/6861992">这里</a>或<a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-object-excel">这里</a>；表格的数据用<strong>xlsread</strong>读入处理. </p>
<p>另外做了一些强化, 包括: </p>
<ul>
<li>1.打印处理表格的基本信息和没有计入绩点计算的课程的修读人数情况, 便于查错. </li>
<li>2.增设了几个可调变量, 包括判定为重修与双学位课程的修读人数阈值等. </li>
<li>3.程序自动扫描当前文件夹下所有excel文档, 批量处理, 处理后文档输出到新建的Output文件夹. </li>
</ul>
<p>下面是code</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% forfreedom.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">forfreedom</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">%% 初始化 自定义参数设定</span></span><br><span class="line">    clc</span><br><span class="line">    clear</span><br><span class="line">    close all</span><br><span class="line">    <span class="comment">%======================== 一般只需要在画线区域修改 ============================</span></span><br><span class="line">    stu_ppt = <span class="number">0.2</span>; <span class="comment">% 当选课人数少于总人数的 stu_ppt * 100%, 认为该课为重修或双学位课程, 默认 20%</span></span><br><span class="line">    score_mdf = <span class="number">60</span>; <span class="comment">% 挂科的按 score_mdf 来算绩点, 默认以 60分来算</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">%======================== 一般只需要在画线区域修改 ============================</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;开始工作咯, 计时, 滴~&#x27;</span>);</span><br><span class="line">    tic</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%% 读取excel文档</span></span><br><span class="line">    e = actxserver(<span class="string">&#x27;excel.application&#x27;</span>); <span class="comment">% 建立excel数据类</span></span><br><span class="line">    path = pwd;</span><br><span class="line">    xlsfiles = dir(fullfile(path, <span class="string">&#x27;*.xls&#x27;</span>));</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;这个目录下有&#x27;</span> num2str(<span class="built_in">size</span>(xlsfiles, <span class="number">1</span>)) <span class="string">&#x27;张表格&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span> : <span class="built_in">size</span>(xlsfiles)</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;正在处理第&#x27;</span> num2str(<span class="built_in">j</span>) <span class="string">&#x27;张表格&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;!&#x27;</span>]);</span><br><span class="line">        xls_file_name = xlsfiles(<span class="built_in">j</span>).name;</span><br><span class="line">        WorkBook = e.Workbooks.Open([path <span class="string">&#x27;/&#x27;</span> xls_file_name]);</span><br><span class="line"></span><br><span class="line">        sheets = e.ActiveWorkBook.Sheets;</span><br><span class="line">        sheet1 = sheets.Item(<span class="number">1</span>); <span class="comment">% 获得sheet1</span></span><br><span class="line">    <span class="comment">%     e.Visible = 1;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">% 读入excel的数据</span></span><br><span class="line">        [~, xls] = xlsread([path <span class="string">&#x27;/&#x27;</span> xls_file_name], <span class="number">1</span>);</span><br><span class="line">        [xls_n, xls_p] = <span class="built_in">size</span>(xls);</span><br><span class="line"></span><br><span class="line">        <span class="comment">%% 预处理 1.数据分割, 参数计算    2.去除成绩中的字符     3.去除重修、双学位科目数据           </span></span><br><span class="line">        <span class="comment">% 数据分割 参数计算</span></span><br><span class="line">        xls_title = xls&#123;<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">        stu_num = xls_n - <span class="number">5</span>; <span class="comment">% 学生人数</span></span><br><span class="line">        stu_nam = xls(<span class="number">6</span> : <span class="keyword">end</span>, <span class="number">4</span>); <span class="comment">%学生姓名</span></span><br><span class="line">        course_nam = xls(<span class="number">3</span>, <span class="number">5</span> : <span class="keyword">end</span> - <span class="number">3</span>); <span class="comment">% 课程名</span></span><br><span class="line">        course_cred = str2num(cell2mat(xls(<span class="number">4</span>, <span class="number">5</span> : <span class="keyword">end</span> - <span class="number">3</span>))); <span class="comment">%课程学分</span></span><br><span class="line">        score_matrix = xls(<span class="number">6</span> : <span class="keyword">end</span>, <span class="number">5</span> : <span class="keyword">end</span> - <span class="number">3</span>); <span class="comment">% 分数矩阵</span></span><br><span class="line">        [score_matrix_n, score_matrix_p] = <span class="built_in">size</span>(score_matrix);</span><br><span class="line">        appendx = xls(<span class="number">6</span> : <span class="keyword">end</span>, <span class="keyword">end</span> - <span class="number">2</span> : <span class="keyword">end</span>); <span class="comment">%最后三列</span></span><br><span class="line"></span><br><span class="line">        toc</span><br><span class="line">        fprintf(<span class="string">&#x27;表格基本信息: \n表格标题: %s\n班级人数: %d\n总课程数: %d\n&#x27;</span>, ...</span><br><span class="line">            xls_title, stu_num, <span class="built_in">length</span>(course_nam));</span><br><span class="line"></span><br><span class="line">        <span class="comment">% 分数矩阵处理</span></span><br><span class="line">        <span class="comment">% 非法字符处理</span></span><br><span class="line">        [score_matrix&#123;strncmp(&#123;<span class="string">&#x27;优&#x27;</span>&#125;, score_matrix, <span class="number">1</span>)&#125;] = deal(<span class="string">&#x27;95.0&#x27;</span>); <span class="comment">% 处理 优 良 及格 不及格</span></span><br><span class="line">        [score_matrix&#123;strncmp(&#123;<span class="string">&#x27;良&#x27;</span>&#125;, score_matrix, <span class="number">1</span>)&#125;] = deal(<span class="string">&#x27;85&#x27;</span>); </span><br><span class="line">        [score_matrix&#123;strncmp(&#123;<span class="string">&#x27;及格&#x27;</span>&#125;, score_matrix, <span class="number">1</span>)&#125;] = deal(<span class="string">&#x27;65.0&#x27;</span>); </span><br><span class="line">        [score_matrix&#123;strncmp(&#123;<span class="string">&#x27;不及格&#x27;</span>&#125;, score_matrix, <span class="number">1</span>)&#125;] = deal(<span class="string">&#x27;50&#x27;</span>); </span><br><span class="line">        [score_matrix&#123;strncmp(&#123;<span class="string">&#x27;-&#x27;</span>&#125;, score_matrix, <span class="number">1</span>)&#125;] = deal(<span class="string">&#x27;-1&#x27;</span>); <span class="comment">% 处理 &#x27;-&#x27;   </span></span><br><span class="line">        <span class="comment">% 元胞数组 转 数值矩阵</span></span><br><span class="line">        score_matrix_num = <span class="built_in">cellfun</span>(@str2num, score_matrix); <span class="comment">% 计算绩点用</span></span><br><span class="line">        score_matrix_mark = score_matrix_num; <span class="comment">%标注不及格成绩用</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">% 去除重修、双学位课程 规则: 有成绩的人数占班级总人数比例低于 stu_ppt * 100%</span></span><br><span class="line">        threshold = <span class="built_in">ceil</span>(stu_num * stu_ppt); <span class="comment">% 选课人数低于threshold认为要忽略课程</span></span><br><span class="line">        course_stu_num = sum(score_matrix_num ~= <span class="number">-1</span>); <span class="comment">% 选课人数</span></span><br><span class="line">        course_delete_mask = course_stu_num &lt;= threshold;<span class="comment">% 找到要删除的课程</span></span><br><span class="line">        course_delete_nam = course_nam(:, course_delete_mask); <span class="comment">% 要删除课程的名字</span></span><br><span class="line">        course_delete_stu_num = course_stu_num(course_delete_mask);</span><br><span class="line"></span><br><span class="line">        toc</span><br><span class="line">        <span class="keyword">if</span> (~<span class="built_in">isempty</span>(course_delete_mask))</span><br><span class="line">            fprintf(<span class="string">&#x27;忽略课程信息: \n有%d门课的成绩没有纳入计算绩点, 这些课可能是重修或双学位课程\n这些课程是:\n&#x27;</span>, ...</span><br><span class="line">                sum(course_delete_mask));</span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span> : sum(course_delete_mask)</span><br><span class="line">                fprintf(<span class="string">&#x27;%-30s选课人数: %d\n&#x27;</span>, course_delete_nam&#123;<span class="built_in">i</span>&#125;, course_delete_stu_num(<span class="built_in">i</span>));</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        score_matrix_num(:, course_delete_mask) = []; <span class="comment">% 删除课程分数数据</span></span><br><span class="line">        course_cred(:, course_delete_mask) = []; <span class="comment">% 删除学分数据</span></span><br><span class="line">        course_nam(:, course_delete_mask) = []; <span class="comment">% 删除课程名字</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">%% 计算绩点</span></span><br><span class="line">        score_mdf_mask = score_matrix_num &lt; <span class="number">60</span> &amp; score_matrix_num &gt;= <span class="number">0</span>; <span class="comment">% 选出挂科的成绩</span></span><br><span class="line">        score_matrix_num(score_mdf_mask) = score_mdf; <span class="comment">% 考试没过成绩修改</span></span><br><span class="line">        score_matrix_num(score_matrix_num &lt; <span class="number">0</span>) = <span class="number">50</span>; <span class="comment">% 没出成绩, 可能缺考, 先算50</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">% 计算 GPA</span></span><br><span class="line">        GPA = <span class="built_in">round</span>((score_matrix_num - <span class="number">50</span>) * course_cred&#x27; ./ (sum(course_cred) * <span class="number">10</span>), <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">%% 修改表结构 + 填入绩点 + 填入排名</span></span><br><span class="line">        sheet1.Range([<span class="string">&#x27;F1:F&#x27;</span> num2str(xls_n)]).Insert; <span class="comment">% 绩点</span></span><br><span class="line">        sheet1.Range([<span class="string">&#x27;F1:F&#x27;</span> num2str(xls_n)]).Insert; <span class="comment">% 排名</span></span><br><span class="line">        sheet1.Range(<span class="string">&#x27;F5&#x27;</span>).Value = <span class="string">&#x27;绩点&#x27;</span>;</span><br><span class="line">        sheet1.Range(<span class="string">&#x27;G5&#x27;</span>).Value = <span class="string">&#x27;排名&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        sheet1.Range([<span class="string">&#x27;F6:F&#x27;</span> num2str(<span class="number">6</span> + stu_num - <span class="number">1</span>)]).Value = GPA;</span><br><span class="line">        sheet1.Range([<span class="string">&#x27;F6:G&#x27;</span> num2str(<span class="number">6</span> + stu_num)]).HorizontalAlignment = <span class="number">-4108</span>; <span class="comment">%居中</span></span><br><span class="line">        sheet1.Range([<span class="string">&#x27;F&#x27;</span> num2str(<span class="number">6</span> + stu_num)]).Value = <span class="built_in">round</span>(<span class="built_in">mean</span>(GPA), <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        [~, r] = <span class="built_in">sort</span>(GPA, <span class="string">&#x27;descend&#x27;</span>);</span><br><span class="line">        [~, r] = <span class="built_in">sort</span>(r);</span><br><span class="line">        sheet1.Range([<span class="string">&#x27;G6:G&#x27;</span> num2str(<span class="number">6</span> + stu_num - <span class="number">1</span>)]).Value = r;</span><br><span class="line"></span><br><span class="line">        <span class="comment">%% 将未及格的课程标为黄色</span></span><br><span class="line">        score_matrix_mark_mask = score_matrix_mark &lt; <span class="number">60</span> &amp; score_matrix_mark &gt;=<span class="number">0</span>;</span><br><span class="line">        [n, p] = <span class="built_in">find</span>(score_matrix_mark_mask == <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span> : sum(score_matrix_mark_mask(:))</span><br><span class="line">            sheet1.Range(mark_score_excel_coor(n(<span class="built_in">i</span>) + <span class="number">5</span>, p(<span class="built_in">i</span>)+ <span class="number">7</span>)).Interior.ColorIndex = <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">%% 保存excel</span></span><br><span class="line">        <span class="keyword">if</span> ~exist(<span class="string">&#x27;Output&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>) </span><br><span class="line">            mkdir(<span class="string">&#x27;Output&#x27;</span>)</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        WorkBook.SaveAs([path <span class="string">&#x27;/Output/&#x27;</span> xls_file_name]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    e.Quit;</span><br><span class="line">    e.delete;</span><br><span class="line">    toc</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;呼~处理完毕*^-^*&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 坐标转换</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">excel_coor</span> = <span class="title">mark_score_excel_coor</span><span class="params">(n, p)</span></span></span><br><span class="line"></span><br><span class="line">     excel_coor = [ex(p) num2str(n)];</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">excel_coor_p</span> = <span class="title">ex</span><span class="params">(p)</span></span></span><br><span class="line">    <span class="keyword">if</span> p &gt; <span class="number">26</span></span><br><span class="line">        s = ex(<span class="built_in">fix</span>((p<span class="number">-1</span>) / <span class="number">26</span>));</span><br><span class="line">        excel_coor_p = [s char(<span class="number">65</span> + <span class="built_in">mod</span>(p<span class="number">-1</span>, <span class="number">26</span>))];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        excel_coor_p = char(<span class="number">65</span> + p - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>处理结果显示如下: </p>
<p><img src="https://raw.githubusercontent.com/Granvallen/granvallen.github.io/master/img/sheet2.PNG"  style="zoom:40%" alt="" align=center /></p>
<p>输出表格如下: </p>
<p><img src="https://raw.githubusercontent.com/Granvallen/granvallen.github.io/master/img/sheet3.PNG"  style="zoom:40%" alt="" align=center /></p>
<p>其中可能值得一说的是matlab矩阵索引坐标转换为excel表格索引的处理, 比如matlab中矩阵坐标(1, 2), 对应excel坐标是(1, B). 查了一圈好像没什么人碰到这个问题就自己写了. 其实主要要解决的是列坐标的转换问题. excel的列坐标序号是, 从A到Z, 然后是AA到AZ, 之后BA…, 我想你看出来了, 这本质上就是26进制的计数系统, 我用了一个递归算法实现了他. </p>
<p>刚写完, 然而…今年不用算绩点了. . .<br>.<br>.<br>.<br>.<br>.<br>.<br>.<br>.<br>.<br>終わり</p>
</div><div class="tags"><a href="/tags/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A/"><i class="fa fa-tag"></i>不务正业</a><a href="/tags/Matlab/"><i class="fa fa-tag"></i>Matlab</a></div><div class="post-nav"><a class="pre" href="/linearregression/">浅谈线性回归</a><a class="next" href="/sampling/">关于采样的总结</a></div><div id="tcomment"></div><script src="https://unpkg.com/twikoo@1.5.7/dist/twikoo.all.min.js"></script><script>twikoo.init({
  envId: 'https://granvallen.github.io/',
  el: '#tcomment',
  region: '',
  path: ''
})</script></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">Granvallen.</a> <br /> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> Theme by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>